{% extends 'monitorings/base_monitoring_detail.html' %}
{% load i18n humanize bootstrap_pagination feder_tags %}
{% block content_object %}
    {% include 'monitorings/_tabs.html' with tab='answers_categories' %}
    <style>
        .content-frame {
            border: 1px solid darkgray; /* Black border */
            background-color: white; /* White background */
            padding: 10px; /* Optional: Add padding for content inside the div */
        }
        .input-group {
            width: 100%;
        }
        .btn-send {
            display: none;
        }
    </style>
    <h3 class="sr-only">{% trans "Answers categories" %}</h3>
    <div class="gray">
        {% for key, value in answers_categories.items %}
            <h4><b>{% trans "Question number: " %}{{key}}</b></h4>
            <div class="content-frame">
                    {{value.question}}
            </div>
            <div class="row">
                <div class="col-md-6">
                    <h5><b>{% trans "Answes categories with prompt support instruction:"  %}</b></h5>
                </div>
            </div>
            <form class="message-form" method="post">
                {%csrf_token%}
                <div class="input-group">
                    <input type="hidden" id="{{key|spaces_to_underscores}}" 
                        name="question" value="{{key}}">
                    <textarea id="{{key|spaces_to_underscores}}" type="text"
                        name="answer_categories" class="form-control message-input" 
                        placeholder="{% trans 'Type your answer categories' %}..."
                        >{{value.answer_categories}}</textarea>
                    <div class="input-group-append">
                        <button type="submit" id="{{key|spaces_to_underscores}}"
                            class="btn btn-primary btn-send">{% trans 'Update answer categories' %}</button>
                    </div>
                </div>
            </form>
            <br><br>
        {% endfor %}
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/autosize.js/4.0.2/autosize.min.js"></script>
    <script>
        autosize(document.querySelectorAll('textarea'));
        var textareas = document.querySelectorAll('textarea');
        var buttons = document.querySelectorAll('.btn-send');

        textareas.forEach(function(textarea) {
            textarea.addEventListener('input', function() {
                var activeTextareaId = this.id;

                // Disable all other textareas
                textareas.forEach(function(otherTextarea) {
                    if (otherTextarea.id !== activeTextareaId) {
                        otherTextarea.disabled = true;
                    }
                });

                // Show the corresponding button
                buttons.forEach(function(button) {
                    if (button.id === activeTextareaId) {
                        button.style.display = 'block';
                    }
                });
            });
        });
    </script>
    </script>
{% endblock %}
